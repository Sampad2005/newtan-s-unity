<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Panel - Newtan's Unity</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="styles.css">
    <style>
        .admin-container {
            min-height: 100vh;
            background: #f8f9fa;
        }

        .admin-header {
            background: white;
            padding: 20px 0;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            margin-bottom: 30px;
        }

        .admin-nav {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .admin-logo {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .admin-logo img {
            width: 50px;
            height: auto;
        }

        .admin-actions {
            display: flex;
            gap: 15px;
            align-items: center;
        }

        .admin-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 30px;
            border-bottom: 2px solid #e0e0e0;
        }

        .admin-tab {
            padding: 12px 25px;
            background: none;
            border: none;
            border-bottom: 3px solid transparent;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s;
            color: #666;
        }

        .admin-tab.active {
            color: #3498db;
            border-bottom-color: #3498db;
            font-weight: 600;
        }

        .admin-content {
            display: none;
        }

        .admin-content.active {
            display: block;
        }

        /* Upload Form Styles */
        .upload-form {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.08);
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #2c3e50;
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 1rem;
            transition: all 0.3s;
        }

        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            border-color: #3498db;
            outline: none;
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.1);
        }

        .form-group textarea {
            resize: vertical;
            min-height: 100px;
        }

        .file-upload {
            border: 2px dashed #bdc3c7;
            border-radius: 8px;
            padding: 30px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
        }

        .file-upload:hover {
            border-color: #3498db;
            background: #f8f9fa;
        }

        .file-upload i {
            font-size: 2rem;
            color: #bdc3c7;
            margin-bottom: 10px;
        }

        .file-upload input {
            display: none;
        }

        .submit-btn {
            background: #27ae60;
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            gap: 10px;
        }

        .submit-btn:hover {
            background: #219653;
            transform: translateY(-2px);
        }

        /* Notes Management */
        .notes-management {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.08);
        }

        .management-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .notes-list {
            display: grid;
            gap: 15px;
        }

        .note-management-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            transition: all 0.3s;
        }

        .note-management-item:hover {
            background: #f8f9fa;
        }

        .note-info h4 {
            margin: 0 0 5px 0;
            color: #2c3e50;
        }

        .note-meta {
            display: flex;
            gap: 15px;
            font-size: 0.9rem;
            color: #666;
        }

        .note-actions {
            display: flex;
            gap: 10px;
        }

        .btn-edit, .btn-delete {
            padding: 6px 12px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: all 0.3s;
        }

        .btn-edit {
            background: #3498db;
            color: white;
        }

        .btn-delete {
            background: #e74c3c;
            color: white;
        }

        .btn-edit:hover, .btn-delete:hover {
            transform: translateY(-1px);
        }

        /* Statistics */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: white;
            padding: 25px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.08);
            text-align: center;
        }

        .stat-number {
            font-size: 2.5rem;
            font-weight: 700;
            color: #3498db;
            margin-bottom: 10px;
        }

        .stat-label {
            color: #666;
            font-size: 1rem;
        }

        .search-box {
            position: relative;
            flex: 1;
            max-width: 300px;
        }

        .search-box .fa-search {
            position: absolute;
            left: 15px;
            top: 50%;
            transform: translateY(-50%);
            color: #666;
        }

        .search-box input {
            width: 100%;
            padding: 10px 15px 10px 45px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 1rem;
        }

        .no-notes {
            text-align: center;
            padding: 60px 20px;
            color: #666;
        }

        .no-notes .fa-file-alt {
            font-size: 3rem;
            margin-bottom: 20px;
            color: #bdc3c7;
        }

        .no-notes h4 {
            margin-bottom: 10px;
            color: #2c3e50;
        }

        @media (max-width: 768px) {
            .form-row {
                grid-template-columns: 1fr;
            }
            
            .admin-nav {
                flex-direction: column;
                gap: 15px;
                text-align: center;
            }
            
            .admin-tabs {
                flex-wrap: wrap;
            }
            
            .management-header {
                flex-direction: column;
                gap: 15px;
                align-items: stretch;
            }
            
            .note-management-item {
                flex-direction: column;
                align-items: flex-start;
                gap: 15px;
            }
            
            .note-actions {
                align-self: flex-end;
            }
        }
    </style>
</head>
<body>
    <div class="admin-container">
        <div class="admin-header">
            <div class="container">
                <div class="admin-nav">
                    <div class="admin-logo">
                        <img src="image.png" alt="Newtan's Unity Logo">
                        <div>
                            <h2>Teacher Admin Panel</h2>
                            <p>Manage study materials and content</p>
                        </div>
                    </div>
                    <div class="admin-actions">
                        <a href="main.html" class="btn btn-outline" onclick="viewWebsite()">
                            <i class="fas fa-globe"></i> View Website
                        </a>
                        <button id="logoutBtn" class="btn btn-primary">
                            <i class="fas fa-sign-out-alt"></i> Logout
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <div class="container">
            <div class="admin-tabs">
                <button class="admin-tab active" data-tab="upload">Upload Notes</button>
                <button class="admin-tab" data-tab="manage">Manage Notes</button>
                <button class="admin-tab" data-tab="stats">Statistics</button>
            </div>

            <!-- Upload Tab -->
            <div class="admin-content active" id="upload-tab">
                <form id="uploadForm" class="upload-form">
                    <div class="form-row">
                        <div class="form-group">
                            <label>Note Title *</label>
                            <input type="text" id="noteTitle" required placeholder="Enter note title">
                        </div>
                        <div class="form-group">
                            <label>Category *</label>
                            <select id="noteCategory" required>
                                <option value="">Select Category</option>
                                <option value="physical">Physical Geography</option>
                                <option value="human">Human Geography</option>
                                <option value="practical">Practical Geography</option>
                                <option value="questions">Question Papers</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label>Class Level *</label>
                            <select id="noteClass" required>
                                <option value="">Select Class</option>
                                <option value="all">All Levels</option>
                                <option value="10">Class 10</option>
                                <option value="11">Class 11</option>
                                <option value="12">Class 12</option>
                                <option value="university">University</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>File Size (MB)</label>
                            <input type="number" id="fileSize" step="0.1" placeholder="e.g., 2.5" required>
                        </div>
                    </div>

                    <div class="form-group">
                        <label>Description *</label>
                        <textarea id="noteDescription" required placeholder="Enter note description"></textarea>
                    </div>

                    <div class="form-group">
                        <label>Google Drive File ID *</label>
                        <input type="text" id="fileId" required placeholder="Paste Google Drive File ID">
                        <small style="color: #666; margin-top: 5px; display: block;">
                            How to get File ID: Upload to Google Drive → Share → Copy link → Extract the ID between /d/ and /view
                        </small>
                    </div>

                    <div class="form-group">
                        <label>Number of Pages</label>
                        <input type="number" id="notePages" placeholder="Enter number of pages">
                    </div>

                    <button type="submit" class="submit-btn">
                        <i class="fas fa-upload"></i> Upload Note
                    </button>
                </form>
            </div>

            <!-- Manage Tab -->
            <div class="admin-content" id="manage-tab">
                <div class="notes-management">
                    <div class="management-header">
                        <h3>Manage Uploaded Notes</h3>
                        <div class="search-box">
                            <i class="fas fa-search"></i>
                            <input type="text" id="searchManage" placeholder="Search notes...">
                        </div>
                    </div>
                    <div class="notes-list" id="manageNotesList">
                        <!-- Notes will be loaded here -->
                    </div>
                </div>
            </div>

            <!-- Statistics Tab -->
            <div class="admin-content" id="stats-tab">
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-number" id="totalNotes">0</div>
                        <div class="stat-label">Total Notes</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="physicalNotes">0</div>
                        <div class="stat-label">Physical Geography</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="humanNotes">0</div>
                        <div class="stat-label">Human Geography</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="questionPapers">0</div>
                        <div class="stat-label">Question Papers</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Check if teacher is logged in
        const loginTime = localStorage.getItem('loginTime');
        const currentTime = new Date().getTime();
        
        if (localStorage.getItem('isLoggedIn') !== 'true' || 
            localStorage.getItem('userType') !== 'teacher' ||
            (currentTime - loginTime) > 7200000) {
            localStorage.removeItem('isLoggedIn');
            localStorage.removeItem('userType');
            localStorage.removeItem('loginTime');
            window.location.href = 'index.html';
        }

        // Update logout button
        document.getElementById('logoutBtn').addEventListener('click', function() {
            localStorage.removeItem('isLoggedIn');
            localStorage.removeItem('userType');
            localStorage.removeItem('loginTime');
            window.location.href = 'index.html';
        });

        // Tab functionality
        document.querySelectorAll('.admin-tab').forEach(tab => {
            tab.addEventListener('click', () => {
                // Remove active class from all tabs and contents
                document.querySelectorAll('.admin-tab').forEach(t => t.classList.remove('active'));
                document.querySelectorAll('.admin-content').forEach(c => c.classList.remove('active'));
                
                // Add active class to clicked tab and content
                tab.classList.add('active');
                document.getElementById(`${tab.dataset.tab}-tab`).classList.add('active');
                
                // Load content based on tab
                if (tab.dataset.tab === 'manage') {
                    loadManageNotes();
                } else if (tab.dataset.tab === 'stats') {
                    loadStatistics();
                }
            });
        });

        // Load notes from localStorage
        function getNotes() {
            const notes = localStorage.getItem('newtanNotes');
            return notes ? JSON.parse(notes) : [];
        }

        // Save notes to localStorage
        function saveNotes(notes) {
            localStorage.setItem('newtanNotes', JSON.stringify(notes));
        }

        // Upload Form Handler
        document.getElementById('uploadForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const newNote = {
                id: Date.now(), // Unique ID
                title: document.getElementById('noteTitle').value,
                category: document.getElementById('noteCategory').value,
                classLevel: document.getElementById('noteClass').value,
                fileId: document.getElementById('fileId').value,
                fileSize: document.getElementById('fileSize').value + ' MB',
                description: document.getElementById('noteDescription').value,
                pages: parseInt(document.getElementById('notePages').value) || 0,
                uploadDate: new Date().toISOString().split('T')[0],
                downloads: 0
            };
            
            // Get existing notes
            const notes = getNotes();
            
            // Add new note
            notes.unshift(newNote);
            
            // Save to localStorage
            saveNotes(notes);
            
            // Reset form
            this.reset();
            
            // Show success message
            alert('Note uploaded successfully!');
            
            // If on manage tab, refresh the list
            if (document.querySelector('.admin-tab.active').dataset.tab === 'manage') {
                loadManageNotes();
            }
            
            // Update statistics
            loadStatistics();
        });

        // Load notes for management
        function loadManageNotes() {
            const notes = getNotes();
            const container = document.getElementById('manageNotesList');
            
            if (notes.length === 0) {
                container.innerHTML = `
                    <div class="no-notes">
                        <i class="fas fa-file-alt"></i>
                        <h4>No notes uploaded yet</h4>
                        <p>Upload your first note using the "Upload Notes" tab</p>
                    </div>
                `;
                return;
            }
            
            container.innerHTML = notes.map(note => `
                <div class="note-management-item" data-id="${note.id}">
                    <div class="note-info">
                        <h4>${note.title}</h4>
                        <div class="note-meta">
                            <span class="category">${getCategoryLabel(note.category)}</span>
                            <span class="class">${getClassLabel(note.classLevel)}</span>
                            <span class="size">${note.fileSize}</span>
                            <span class="date">${formatDate(note.uploadDate)}</span>
                            <span class="downloads">${note.downloads} downloads</span>
                        </div>
                    </div>
                    <div class="note-actions">
                        <button class="btn-edit" onclick="editNote(${note.id})">
                            <i class="fas fa-edit"></i> Edit
                        </button>
                        <button class="btn-delete" onclick="deleteNote(${note.id})">
                            <i class="fas fa-trash"></i> Delete
                        </button>
                    </div>
                </div>
            `).join('');
        }

        // Delete note function
        function deleteNote(noteId) {
            if (confirm('Are you sure you want to delete this note?')) {
                const notes = getNotes();
                const updatedNotes = notes.filter(note => note.id !== noteId);
                saveNotes(updatedNotes);
                loadManageNotes();
                loadStatistics();
            }
        }

        // Edit note function
        function editNote(noteId) {
            const notes = getNotes();
            const note = notes.find(n => n.id === noteId);
            
            if (note) {
                // Populate form with note data
                document.getElementById('noteTitle').value = note.title;
                document.getElementById('noteCategory').value = note.category;
                document.getElementById('noteClass').value = note.classLevel;
                document.getElementById('fileId').value = note.fileId;
                document.getElementById('fileSize').value = parseFloat(note.fileSize);
                document.getElementById('noteDescription').value = note.description;
                document.getElementById('notePages').value = note.pages;
                
                // Switch to upload tab
                document.querySelectorAll('.admin-tab').forEach(t => t.classList.remove('active'));
                document.querySelectorAll('.admin-content').forEach(c => c.classList.remove('active'));
                document.querySelector('[data-tab="upload"]').classList.add('active');
                document.getElementById('upload-tab').classList.add('active');
                
                // Remove the note (will be re-added when form is submitted)
                const updatedNotes = notes.filter(n => n.id !== noteId);
                saveNotes(updatedNotes);
            }
        }

        // Load statistics
        function loadStatistics() {
            const notes = getNotes();
            
            document.getElementById('totalNotes').textContent = notes.length;
            document.getElementById('physicalNotes').textContent = 
                notes.filter(n => n.category === 'physical').length;
            document.getElementById('humanNotes').textContent = 
                notes.filter(n => n.category === 'human').length;
            document.getElementById('questionPapers').textContent = 
                notes.filter(n => n.category === 'questions').length;
        }

        // Helper functions
        function getCategoryLabel(category) {
            const labels = {
                'physical': 'Physical Geography',
                'human': 'Human Geography',
                'practical': 'Practical Geography',
                'questions': 'Question Papers'
            };
            return labels[category] || category;
        }

        function getClassLabel(classLevel) {
            const labels = {
                'all': 'All Levels',
                '10': 'Class 10',
                '11': 'Class 11',
                '12': 'Class 12',
                'university': 'University'
            };
            return labels[classLevel] || classLevel;
        }

        function formatDate(dateString) {
            const options = { year: 'numeric', month: 'short', day: 'numeric' };
            return new Date(dateString).toLocaleDateString('en-US', options);
        }
        // Function to view website as student
            function viewWebsite() {
                // Set student credentials temporarily to bypass login
                localStorage.setItem('userType', 'student');
                localStorage.setItem('isLoggedIn', 'true');
                localStorage.setItem('loginTime', new Date().getTime());
                
                // Redirect to main website
                window.location.href = 'main.html';
            }

        // Search functionality for manage tab
        document.getElementById('searchManage').addEventListener('input', function(e) {
            const searchTerm = e.target.value.toLowerCase();
            const notes = getNotes();
            const filteredNotes = notes.filter(note => 
                note.title.toLowerCase().includes(searchTerm) || 
                note.description.toLowerCase().includes(searchTerm)
            );
            
            const container = document.getElementById('manageNotesList');
            
            if (filteredNotes.length === 0) {
                container.innerHTML = `
                    <div class="no-notes">
                        <i class="fas fa-search"></i>
                        <h4>No notes found</h4>
                        <p>Try adjusting your search terms</p>
                    </div>
                `;
                return;
            }
            
            container.innerHTML = filteredNotes.map(note => `
                <div class="note-management-item" data-id="${note.id}">
                    <div class="note-info">
                        <h4>${note.title}</h4>
                        <div class="note-meta">
                            <span class="category">${getCategoryLabel(note.category)}</span>
                            <span class="class">${getClassLabel(note.classLevel)}</span>
                            <span class="size">${note.fileSize}</span>
                            <span class="date">${formatDate(note.uploadDate)}</span>
                            <span class="downloads">${note.downloads} downloads</span>
                        </div>
                    </div>
                    <div class="note-actions">
                        <button class="btn-edit" onclick="editNote(${note.id})">
                            <i class="fas fa-edit"></i> Edit
                        </button>
                        <button class="btn-delete" onclick="deleteNote(${note.id})">
                            <i class="fas fa-trash"></i> Delete
                        </button>
                    </div>
                </div>
            `).join('');
        });

        // Initialize
        loadStatistics();
    </script>
</body>
</html>
